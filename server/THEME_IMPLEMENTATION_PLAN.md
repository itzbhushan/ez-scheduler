# Theme-Based Form UI Customization with MinIO Storage

## Overview
Implement dynamic theme generation for registration forms with MinIO object storage on Railway.app for persistent asset storage.

## Architecture Components

### 1. MinIO Storage Setup
- Deploy MinIO on Railway.app using their one-click template
- Create bucket: `ez-scheduler-themes`
- Store CSS files and minimal assets in form-specific directories
- Structure: `forms/{form-id}/theme.css` and `forms/{form-id}/assets/`

### 2. Database Schema Updates
- Add `theme_config` JSON field to `SignupForm` model
- Store theme metadata: inferred_theme, colors, MinIO asset URLs
- Include fallback flags for theme generation failures

### 3. Theme Generation Service
- Create `ThemeGenerationService` class with MinIO client integration
- LLM analyzes event details to infer theme (birthday, wedding, corporate, festival, etc.)
- Generate clean, minimalistic CSS based on theme
- Upload generated CSS to MinIO and return public URLs

### 4. LLM Integration Updates
- Extend `FormExtractionSchema` with `inferred_theme` field
- Update system prompts to include theme inference
- Generate appropriate color schemes and typography for each theme type

### 5. Template System Updates
- Modify `form.html` and `success.html` to dynamically load theme CSS from MinIO URLs
- Maintain TailwindCSS base with theme-specific overrides
- Add fallback to default styling if MinIO assets unavailable

### 6. Integration Points
- Update `create_form_handler` to include theme generation step
- Modify `serve_registration_form` to inject theme URLs
- Add MinIO client configuration and credentials management

## Technical Implementation

### Dependencies
- Add `minio` Python package for S3-compatible client
- Configure MinIO credentials via environment variables
- Use boto3-compatible API calls for familiarity

### Storage Pattern
```
MinIO Bucket: ez-scheduler-themes
├── forms/
│   ├── form-uuid-1/
│   │   ├── theme.css
│   │   └── assets/ (minimal theme-specific assets)
│   └── form-uuid-2/
│       ├── theme.css
│       └── assets/
```

### Theme Examples
- **Birthday**: Warm yellows/pinks with playful elements
- **Wedding**: Elegant whites/golds with refined typography
- **Corporate**: Professional blues/grays with clean lines
- **Festival**: Rich cultural colors with subtle motifs
- **Housewarming**: Earthy greens/browns with welcoming tones

## Benefits
- Persistent storage across Railway deployments
- S3-compatible API for easy integration
- Self-hosted solution within Railway ecosystem
- Automatic cleanup when forms are deleted
- Fast asset delivery with MinIO's performance
- Clean separation of generated assets from application code

## Implementation Steps
1. Deploy MinIO instance on Railway.app
2. Add MinIO client dependencies to project
3. Create ThemeGenerationService with LLM integration
4. Update database schema with theme_config field
5. Modify form creation workflow to generate themes
6. Update templates to load theme CSS from MinIO
7. Add fallback mechanisms for theme failures
8. Test with various event types and themes

## Golu Theme (Initial Hand-Crafted MVP)

Before the full MinIO-backed generator ships, we added a zero-dependency MVP theme so design validation can begin immediately.

- New template: `server/src/ez_scheduler/templates/themes/golu_form.html`
- Router switch: `GET /form/{slug}?theme=golu` or set `DEFAULT_FORM_THEME=golu` in `.env`
- Reuses existing form submission and fields; only presentation changes
- Inline CSS with display fonts (Cinzel, Cormorant Garamond) and decorative peacock SVG

Design tokens:
- Colors: `--navy #0f1e2e`, `--gold #c9a227`, `--cream #efe1bf`, `--ink #1a1a1a`
- Elements: outer ornamental frame, hero headings, cream rounded card for fields, gold CTA button

Migration path to generator:
1) Move inline CSS into `theme.css` generated by ThemeGenerationService
2) Store in MinIO at `forms/{form-id}/theme.css` and load via Jinja variable
3) Extend `SignupForm.theme_config` with `{ inferred_theme: "golu", assets_url, css_url }`
4) Keep `?theme=` override for debugging and manual previews

## Current Analysis Complete
- ✅ Current form template structure analyzed (form.html, success.html)
- ✅ Theme inference system designed using LLM
- ✅ MinIO storage research completed
- ⏳ Ready for implementation phase

## Requirements Met
- ✅ Visual appeal: clean and minimalistic design approach
- ✅ Persistent UI: theme stored in MinIO for consistent serving
- ✅ Minimal images: focus on CSS-based theming
- ✅ Form-ID directories: organized storage structure in MinIO
- ✅ LLM theme inference: automatic theme detection from event details
